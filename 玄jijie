<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>玄寂界 - 金光降世</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    
    <style>
        /* 视觉样式部分与上一版相同，已解决毛玻璃和居中问题，此处保持不变 */
        body{margin:0;font-family:'ZCOOL KuaiLe',sans-serif;color:#fff;overflow-x:hidden}#video-background{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);min-width:100%;min-height:100%;width:auto;height:auto;z-index:-1000;object-fit:cover;filter:brightness(.7)}
        .container{max-width:800px;margin:20px auto;padding:25px;background:rgba(10,5,0,.2);border:2px solid #ffd700;border-radius:15px;box-shadow:0 0 25px rgba(255,215,0,.7),0 0 10px rgba(255,215,0,.5) inset}
        h1{text-align:center;font-size:3.5em;color:#fff;text-shadow:0 0 5px #ffd700,0 0 15px #ffd700,0 0 25px #ffae00,0 3px 3px #000,0 8px 20px rgba(0,0,0,.9);animation:float-glow 5s ease-in-out infinite}
        @keyframes float-glow{0%,100%{transform:translateY(0);text-shadow:0 0 5px #ffd700,0 0 15px #ffd700,0 0 25px #ffae00,0 3px 3px #000,0 8px 20px rgba(0,0,0,.9)}50%{transform:translateY(-10px);text-shadow:0 0 10px #fff,0 0 25px #ffd700,0 0 40px #ffae00,0 13px 8px #000,0 20px 25px rgba(0,0,0,.9)}}
        .meta,.feedback{text-align:center;margin-bottom:20px;text-shadow:0 2px 3px #000;font-size:1.1em}.collapsible-trigger{text-shadow:1px 1px 0 #000,0 0 8px rgba(0,0,0,.9)}.content{font-size:1.2em;text-shadow:0 2px 3px #000}
        .meta span{margin:0 15px}.feedback a{color:#fde047;text-decoration:none;transition:all .3s ease}.feedback a:hover{color:#fff;text-shadow:0 0 10px #fde047}.collapsible-wrapper{transition:opacity .8s ease,display .8s ease}.collapsible-item{margin-bottom:15px}.collapsible-trigger{background:linear-gradient(45deg,rgba(255,215,0,.2),rgba(200,160,0,.4));color:#fff;cursor:pointer;padding:15px 20px;width:100%;border:1px solid #ffd700;border-radius:8px;text-align:left;outline:none;font-size:1.4em;transition:all .4s ease;box-shadow:0 2px 5px rgba(0,0,0,.5)}.collapsible-trigger:hover,.collapsible-trigger.active{background:linear-gradient(45deg,rgba(255,215,0,.4),rgba(220,180,0,.6));box-shadow:0 0 15px rgba(255,215,0,.5);transform:scale(1.02)}.content{padding:0 20px;max-height:0;overflow:hidden;transition:max-height .5s cubic-bezier(0.4,0,0.2,1);background-color:rgba(0,0,0,.3);border-radius:0 0 8px 8px;border:1px solid #ffd700;border-top:none}.content div,.content ul,.content p{margin:15px 0}.content ul{list-style-type:none;padding-left:10px}.content li{margin-bottom:10px}strong{color:#fde047}.choice-container{text-align:center;margin-top:20px;padding-bottom:15px}.choice-button{font-family:'ZCOOL KuaiLe',sans-serif;background:linear-gradient(45deg,#a78bfa,#7c3aed);color:#fff;border:2px solid #c4b5fd;padding:12px 25px;text-align:center;text-decoration:none;display:inline-block;font-size:1.2em;margin:8px 5px;cursor:pointer;border-radius:8px;transition:all .3s ease;text-shadow:1px 1px 0 #000;box-shadow:0 4px 6px rgba(0,0,0,.4),0 1px 3px rgba(0,0,0,.2),inset 0 -2px 1px rgba(255,255,255,.2)}.choice-button:hover{transform:translateY(-2px);box-shadow:0 6px 10px rgba(0,0,0,.5),0 2px 5px rgba(0,0,0,.3),inset 0 -2px 1px rgba(255,255,255,.2)}.choice-button.back{background:linear-gradient(45deg,#6b7280,#4b5563);border-color:#9ca3af}
    </style>
</head>
<body>

<video autoplay muted loop id="video-background">
    <source src="https://raw.githubusercontent.com/penguinp-star/xuanjijie/main/lv_0_20250722185633.mp4" type="video/mp4">
    您的浏览器不支持视频标签。
</video>

<div class="container">
    <!-- HTML 结构保持不变 -->
    <h1>玄寂界</h1>
    <div class="meta">...</div>
    <div class="feedback">...</div>
    <div class="collapsible-wrapper">
        <!-- ... 折叠项内容保持不变 ... -->
        <div class="collapsible-item"><button class="collapsible-trigger">世界简介</button><div class="content"><p>...</p></div></div>
        <div class="collapsible-item"><button class="collapsible-trigger">人物介绍</button><div class="content">...</div></div>
        <div class="collapsible-item"><button class="collapsible-trigger">规则介绍</button><div class="content">...</div></div>
        <div class="collapsible-item"><button class="collapsible-trigger">修为介绍</button><div class="content">...</div></div>
        <div class="collapsible-item" id="game-start-item"><button class="collapsible-trigger" id="startGameBtn">开始游戏</button><div class="content" id="game-content"><div id="choice-container"><button class="choice-button" data-path="正道">正道</button><button class="choice-button" data-path="魔道">魔道</button></div><div id="opening-scene" style="display:none;"><p id="opening-text"></p><div class="choice-container"><button class="choice-button" id="final-start-btn">开始</button><button class="choice-button back" id="go-back-btn">返回</button></div></div></div></div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // 【第三步：在这里配置】
    
    // 1. 在下面引号里，粘贴您【唯一】的角色卡直接链接
    const characterCardUrl = 'https://raw.githubusercontent.com/penguinp-star/xuanjijie/main/我的徒弟颇有圣尊之姿1_1.png';

    // 2. 这里是两个阵营对应的“额外问候语”，您可以按需修改
    const greetings = {
        '正道': '霞光万道，瑞气千条。你已踏上正道仙途，前路漫漫，愿你坚守本心，斩妖除魔，终有一日，名动天下，得道飞升！',
        '魔道': '月黑风高，杀意凛然。你已选择魔道之路，此去当踏着累累白骨，逆天而行。愿你快意恩仇，不受束缚，成为令三界闻风丧胆的一代枭雄！'
    };

    // --- 下方的代码无需修改 ---
    const finalStartBtn = document.getElementById('final-start-btn');
    let selectedPath = '';

    // 【核心修正】点击最终“开始”按钮的事件
    finalStartBtn.addEventListener('click', function() {
        if (!selectedPath) return;

        // 检查您是否已配置角色卡链接
        if (!characterCardUrl || characterCardUrl.startsWith('在这里粘贴')) {
            alert('错误：角色卡链接尚未配置！\n\n请编辑HTML文件，在<script>标签内填入角色卡的直接链接。');
            return;
        }

        // 获取选择的问候语
        const selectedGreeting = greetings[selectedPath];

        // 生成最终的 SillyTavern 链接，并对URL和问候语进行编码，防止出错
        const sillyTavernLink = `sillytavern://importcharacter?url=${encodeURIComponent(characterCardUrl)}&greeting=${encodeURIComponent(selectedGreeting)}`;

        // 执行跳转
        window.location.href = sillyTavernLink;
    });

    // --- 其他无需修改的辅助JS逻辑 ---
    const collapsibles=document.querySelectorAll(".collapsible-trigger"),gameContent=document.getElementById("game-content"),choiceContainer=document.getElementById("choice-container"),openingScene=document.getElementById("opening-scene"),openingText=document.getElementById("opening-text"),goBackBtn=document.getElementById("go-back-btn"),openingContent={正道:"青石板铺就的山道蜿蜒曲折...",魔道:"月色如霜，冰冷地洒在..."};collapsibles.forEach(b=>{b.addEventListener("click",function(){const c=this.classList.contains("active");document.querySelectorAll(".collapsible-trigger.active").forEach(d=>{d.classList.remove("active");d.nextElementSibling.style.maxHeight=null});c||(this.classList.add("active"),this.nextElementSibling.style.maxHeight=this.nextElementSibling.scrollHeight+"px")})});choiceContainer.addEventListener("click",function(e){if(e.target.classList.contains("choice-button")){selectedPath=e.target.dataset.path;choiceContainer.style.display="none";openingScene.style.display="block";openingText.innerText=openingContent[selectedPath];gameContent.style.maxHeight=gameContent.scrollHeight+"px"}});goBackBtn.addEventListener("click",function(){openingScene.style.display="none";choiceContainer.style.display="block";selectedPath="";gameContent.style.maxHeight=choiceContainer.scrollHeight+"px"});
});
</script>

</body>
</html>
