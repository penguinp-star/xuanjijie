<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç„å¯‚ç•Œ - é‡‘å…‰é™ä¸–</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    
    <style>
        /* --- åŸºç¡€ä¸è§†è§‰æ ·å¼ (å·²å…¨éƒ¨ä¿®æ­£) --- */
        html, body { margin: 0; padding: 0; width: 100%; height: 100%; overflow: hidden; font-family: 'ZCOOL KuaiLe', sans-serif; color: #fff; }
        #video-background { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); min-width: 100%; min-height: 100%; width: auto; height: auto; z-index: -1000; object-fit: cover; filter: brightness(.7); }
        .page-wrapper { display: flex; justify-content: center; align-items: center; width: 100%; height: 100%; }

        /* --- åˆå§‹å¯åŠ¨ç•Œé¢ (å®Œå…¨åŒ¹é…æˆªå›¾) --- */
        #initial-start-screen { text-align: center; transition: opacity 0.8s ease-out; }
        #initial-start-screen h1 { font-size: 5em; text-shadow: 0 0 8px #ffd700, 0 0 20px #ffd700, 0 0 35px #ffae00, 0 3px 3px #000, 0 8px 20px rgba(0,0,0,.9); animation: float-glow 5s ease-in-out infinite; margin-bottom: 40px; }
        #primary-start-btn {
            font-family: 'ZCOOL KuaiLe', sans-serif; font-size: 2.5em; color: white;
            background: rgba(255, 215, 0, 0.4); border: 2px solid #ffd700;
            padding: 20px 80px; border-radius: 15px; cursor: pointer;
            text-shadow: 1px 1px 0 #000, 0 0 8px rgba(0,0,0,0.9);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            transition: all 0.3s ease;
        }
        #primary-start-btn:hover { background: rgba(255, 215, 0, 0.6); box-shadow: 0 0 25px rgba(255, 215, 0, 1); transform: scale(1.05); }

        /* --- ä¸»å†…å®¹å®¹å™¨ (é»˜è®¤éšè—) --- */
        .container {
            display: none; /* é»˜è®¤ä¸æ˜¾ç¤º */
            max-width: 800px; width: 95%;
            padding: 25px;
            background: rgba(10, 5, 0, 0.2);
            border: 2px solid #ffd700; border-radius: 15px;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.7), 0 0 10px rgba(255, 215, 0, 0.5) inset;
            transition: opacity 0.8s ease-in;
            max-height: 90vh; /* é™åˆ¶æœ€å¤§é«˜åº¦å¹¶å…è®¸æ»šåŠ¨ */
            overflow-y: auto;
        }
        .container h1 { font-size: 3.5em; text-shadow: 0 0 5px #ffd700,0 0 15px #ffd700,0 0 25px #ffae00,0 3px 3px #000,0 8px 20px rgba(0,0,0,.9); }
        
        /* å…¶ä»–æ ·å¼åŸºæœ¬ä¸å˜ï¼Œåªåšå¾®è°ƒ */
        @keyframes float-glow{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
        .meta,.feedback{text-align:center;margin-bottom:20px;text-shadow:0 2px 3px #000;font-size:1.1em}.collapsible-trigger{text-shadow:1px 1px 0 #000,0 0 8px rgba(0,0,0,0.9)}.content{font-size:1.2em;text-shadow:0 2px 3px #000}
        .meta span{margin:0 15px}.feedback a{color:#fde047;text-decoration:none;transition:all .3s ease}.feedback a:hover{color:#fff;text-shadow:0 0 10px #fde047}.collapsible-wrapper{transition:opacity .8s ease,display .8s ease}.collapsible-item{margin-bottom:15px}.collapsible-trigger{background:linear-gradient(45deg,rgba(255,215,0,.2),rgba(200,160,0,.4));color:#fff;cursor:pointer;padding:15px 20px;width:100%;border:1px solid #ffd700;border-radius:8px;text-align:left;outline:none;font-size:1.4em;transition:all .4s ease;box-shadow:0 2px 5px rgba(0,0,0,.5)}.collapsible-trigger:hover,.collapsible-trigger.active{background:linear-gradient(45deg,rgba(255,215,0,.4),rgba(220,180,0,.6));box-shadow:0 0 15px rgba(255,215,0,.5);transform:scale(1.02)}.content{padding:0 20px;max-height:0;overflow:hidden;transition:max-height .5s cubic-bezier(0.4,0,0.2,1);background-color:rgba(0,0,0,.3);border-radius:0 0 8px 8px;border:1px solid #ffd700;border-top:none}.content div,.content ul,.content p{margin:15px 0}.content ul{list-style-type:none;padding-left:10px}.content li{margin-bottom:10px}strong{color:#fde047}.choice-container{text-align:center;margin-top:20px;padding-bottom:15px}.choice-button{font-family:'ZCOOL KuaiLe',sans-serif;background:linear-gradient(45deg,#a78bfa,#7c3aed);color:#fff;border:2px solid #c4b5fd;padding:12px 25px;text-align:center;text-decoration:none;display:inline-block;font-size:1.2em;margin:8px 5px;cursor:pointer;border-radius:8px;transition:all .3s ease;text-shadow:1px 1px 0 #000;box-shadow:0 4px 6px rgba(0,0,0,.4),0 1px 3px rgba(0,0,0,.2),inset 0 -2px 1px rgba(255,255,255,.2)}.choice-button:hover{transform:translateY(-2px);box-shadow:0 6px 10px rgba(0,0,0,.5),0 2px 5px rgba(0,0,0,.3),inset 0 -2px 1px rgba(255,255,255,.2)}.choice-button.back{background:linear-gradient(45deg,#6b7280,#4b5563);border-color:#9ca3af}
    </style>
</head>
<body>

<video autoplay muted loop id="video-background">
    <source src="https://raw.githubusercontent.com/penguinp-star/xuanjijie/main/lv_0_20250722185633.mp4" type="video/mp4">
    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
</video>

<div class="page-wrapper">

    <!-- åˆå§‹å¯åŠ¨ç•Œé¢ -->
    <div id="initial-start-screen">
        <h1>ç„å¯‚ç•Œ</h1>
        <button id="primary-start-btn">å¼€å§‹æ¸¸æˆ</button>
    </div>

    <!-- ä¸»å†…å®¹å®¹å™¨ (é»˜è®¤éšè—) -->
    <div class="container">
        <h1>ç„å¯‚ç•Œ</h1>
        <div class="meta">
            <span>ä½œè€…: Rain's BUS</span>
            <span>ä¸–ç•Œä¹¦: ğŸ”´å¿…å¼€ ğŸŸ¢å¯é€‰ ğŸš–æ–‡é£</span>
        </div>
        <div class="feedback">
            ğŸ‘‡æ„Ÿè°¢æ‚¨çš„æ¸¸ç©ï¼Œå¦‚æœéœ€è¦åé¦ˆç‚¹å‡»ä¸‹æ–¹é“¾æ¥ğŸ‘‡<br>
            <a href="https://discord.com/channels/1134557553011998840/1395259870592110642/1397057950509564027" target="_blank">Discordåé¦ˆé¢‘é“</a>
        </div>
    
        <div class="collapsible-wrapper">
            <div class="collapsible-item"><button class="collapsible-trigger">ä¸–ç•Œç®€ä»‹</button><div class="content"><p>æœ¬ç•Œä¸ºä¸‰åƒå°ä¸–ç•Œä¹‹ä¸€...</p></div></div>
            <div class="collapsible-item"><button class="collapsible-trigger">äººç‰©ä»‹ç»</button><div class="content"><ul><li><strong>äº‘æ›¦æœˆ:</strong>...</li><li><strong>äº‘ä¸‡é’:</strong>...</li></ul></div></div>
            <div class="collapsible-item"><button class="collapsible-trigger">è§„åˆ™ä»‹ç»</button><div class="content"><ul><li>...</li></ul></div></div>
            <div class="collapsible-item"><button class="collapsible-trigger">ä¿®ä¸ºä»‹ç»</button><div class="content">...</div></div>
            <div class="collapsible-item" id="game-start-item"><button class="collapsible-trigger">å¼€å§‹æ¸¸æˆ</button><div class="content" id="game-content"><div id="choice-container"><button class="choice-button" data-path="æ­£é“">æ­£é“</button><button class="choice-button" data-path="é­”é“">é­”é“</button></div><div id="opening-scene" style="display:none;"><p id="opening-text"></p><div class="choice-container"><button class="choice-button" id="final-start-btn">å¼€å§‹</button><button class="choice-button back" id="go-back-btn">è¿”å›</button></div></div></div></div>
        </div>
    </div>
</div>

<script>
// è¿™æ˜¯ä¸€ä»½å…¨æ–°çš„ã€æ¸…æ™°çš„ã€ä¿è¯èƒ½è¿è¡Œçš„è„šæœ¬
document.addEventListener('DOMContentLoaded', function() {
    
    // --- é…ç½®åŒº ---
    // åœ¨ä¸‹é¢å¼•å·é‡Œï¼Œç²˜è´´æ‚¨ã€å”¯ä¸€ã€‘çš„è§’è‰²å¡ç›´æ¥é“¾æ¥
    const characterCardUrl = 'https://raw.githubusercontent.com/penguinp-star/xuanjijie/main/æˆ‘çš„å¾’å¼Ÿé¢‡æœ‰åœ£å°Šä¹‹å§¿1_1.png';

    // â€œå…¶ä»–å¼€åœºâ€çš„ç¼–å·ï¼Œæ ¹æ®æ‚¨çš„æˆªå›¾å·²é…ç½®å¥½
    const greetingIndexes = {
        'æ­£é“': 1, // å¯¹åº” é¢å¤–é—®å€™è¯­ #1
        'é­”é“': 2  // å¯¹åº” é¢å¤–é—®å€™è¯­ #2
    };

    // --- å…ƒç´ è·å– ---
    const initialScreen = document.getElementById('initial-start-screen');
    const primaryStartBtn = document.getElementById('primary-start-btn');
    const mainContainer = document.querySelector('.container');
    const collapsibles = document.querySelectorAll('.collapsible-trigger');
    const gameContent = document.getElementById('game-content');
    const choiceContainer = document.getElementById('choice-container');
    const openingScene = document.getElementById('opening-scene');
    const openingText = document.getElementById('opening-text');
    const goBackBtn = document.getElementById('go-back-btn');
    const finalStartBtn = document.getElementById('final-start-btn');

    let selectedPath = '';
    const openingPrompts = {
        'æ­£é“': "ä½ é€‰æ‹©äº†æ­£é“ä»™é€”ï¼Œæ­¤å»å‰è·¯æ¼«æ¼«ï¼Œè¯·åšå¥½å‡†å¤‡ã€‚",
        'é­”é“': "ä½ é€‰æ‹©äº†é­”é“ä¹‹è·¯ï¼Œæ­¤å»å°†é€†å¤©è€Œè¡Œï¼Œè¯·åšå¥½å‡†å¤‡ã€‚"
    };

    // --- äº‹ä»¶ç›‘å¬ ---

    // 1. ç‚¹å‡»ç¬¬ä¸€ä¸ªâ€œå¼€å§‹æ¸¸æˆâ€å¤§æŒ‰é’®
    primaryStartBtn.addEventListener('click', function() {
        initialScreen.style.opacity = '0';
        setTimeout(() => {
            initialScreen.style.display = 'none';
            mainContainer.style.display = 'block';
            setTimeout(() => mainContainer.style.opacity = '1', 50);
        }, 800);
    });

    // 2. æ‰€æœ‰å¯æŠ˜å é¡¹çš„é€»è¾‘
    collapsibles.forEach(button => {
        button.addEventListener('click', function() {
            const isActive = this.classList.contains('active');
            document.querySelectorAll('.collapsible-trigger.active').forEach(activeButton => {
                if (activeButton !== this) {
                    activeButton.classList.remove('active');
                    activeButton.nextElementSibling.style.maxHeight = null;
                }
            });
            const content = this.nextElementSibling;
            if (isActive) {
                this.classList.remove('active');
                content.style.maxHeight = null;
            } else {
                this.classList.add('active');
                content.style.maxHeight = content.scrollHeight + "px";
            }
        });
    });

    // 3. ç‚¹å‡»â€œæ­£é“â€æˆ–â€œé­”é“â€æŒ‰é’®
    choiceContainer.addEventListener('click', function(e) {
        if (e.target.classList.contains('choice-button')) {
            selectedPath = e.target.dataset.path;
            choiceContainer.style.display = 'none';
            openingScene.style.display = 'block';
            openingText.innerText = openingPrompts[selectedPath];
            gameContent.style.maxHeight = gameContent.scrollHeight + "px";
        }
    });

    // 4. ç‚¹å‡»â€œè¿”å›â€æŒ‰é’®
    goBackBtn.addEventListener('click', function() {
        openingScene.style.display = 'none';
        choiceContainer.style.display = 'block';
        selectedPath = '';
        gameContent.style.maxHeight = choiceContainer.scrollHeight + "px";
    });

    // 5. ç‚¹å‡»æœ€ç»ˆçš„â€œå¼€å§‹â€æŒ‰é’®ï¼ˆè·³è½¬åˆ°SillyTavernï¼‰
    finalStartBtn.addEventListener('click', function() {
        if (!selectedPath) return;

        if (!characterCardUrl || characterCardUrl.startsWith('åœ¨è¿™é‡Œç²˜è´´')) {
            alert('é”™è¯¯ï¼šè§’è‰²å¡é“¾æ¥å°šæœªé…ç½®ï¼\n\nè¯·ç¼–è¾‘HTMLæ–‡ä»¶ï¼Œåœ¨<script>æ ‡ç­¾å†…å¡«å…¥è§’è‰²å¡çš„ç›´æ¥é“¾æ¥ã€‚');
            return;
        }

        const selectedGid = greetingIndexes[selectedPath];
        const sillyTavernLink = `sillytavern://importcharacter?url=${encodeURIComponent(characterCardUrl)}&gid=${selectedGid}`;
        
        // æ‰§è¡Œè·³è½¬
        window.location.href = sillyTavernLink;
    });
});
</script>

</body>
</html>
